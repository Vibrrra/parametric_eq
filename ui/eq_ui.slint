

export enum EQFilterType {
        lowpass,
        Highpass,
        bandpass,
        lowshelf,
        highshelf,
        peaking,
}



export struct EqFilter {
    filter_type: EQFilterType,
    frequency: float,
    gain: float,
    q: float,
    enabled: bool,
    selected: bool,
}

export global EQManagerUI {
    in-out property <[EqFilter]> eq_filters: [{filter_type: EQFilterType.lowpass, frequency: 1000.0, gain: 0.0, q: 0.0, enabled: true, selected: false}];
    in-out property <float> test;
    pure callback update_freq(int, float);
    pure callback set_filter_frequency(int, float);

    
}




export component FrequencyController {
    
    in-out property <float> frequency;
    in-out property <bool> huge_frequency;
    in-out property <int> id;
    width: 200px;
    height: 40px;

    Rectangle {
        background: #b7bed2;    
    }
    HorizontalLayout {
        text-input := TextInput {
            vertical-alignment: center;
            horizontal-alignment: center;
            text: frequency;
            width: 40px;
            height: 40px;
            touch-area := TouchArea {
                clicked => { 
                    text-input.focus();
                }
            }
            accepted => {
                EQManagerUI.eq_filters[id].frequency;
                EQManagerUI.set_filter_frequency(id, text-input.text.to-float());
                self.clear-focus();
            }
        }
        Text {
            vertical-alignment: center;
            horizontal-alignment: center;
            text: huge_frequency ? "Hz" : "kHz";
            width: 40px;
            height: 40px;
        }
        test := Text {
            
            vertical-alignment: center;
            horizontal-alignment: center;
            text: EQManagerUI.eq_filters[id].frequency;
            width: 40px;
            height: 40px;
        }
    }
    
}

export component GainController {}
    


export component FilterControlStrip inherits Window{
    width: 800px;
    height: 600px;
    background: #353c51;
    title: "TheEQfromBelow";
    HorizontalLayout {
        FrequencyController {
            width: 200px;
            height: 40px;
        }
    }
    visible: true;
}

export component TestWindow inherits Window {
    width: 800px;
    height: 600px;
    background: #353c51;
    title: "TheEQfromBelow";
    HorizontalLayout {
        FrequencyController {
            frequency: EQManagerUI.eq_filters[0].frequency;
            id: 0;
            width: 200px;
            height: 40px;
        }
    }
    visible: true;
}